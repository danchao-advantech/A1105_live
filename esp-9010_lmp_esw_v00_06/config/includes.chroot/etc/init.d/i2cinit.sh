#!/bin/bash

# Configure Tx Disable
function giga_init() {
        # Configure Tx Disable, PCA9545(0x70), PCA9537(0x49) SFP+*4
        `i2cset -y 1 0x70 0x00 0x01 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x01 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x70 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x00 b`; done

        `i2cset -y 1 0x70 0x00 0x02 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x02 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x70 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x00 b`; done

        `i2cset -y 1 0x70 0x00 0x04 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x04 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x70 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x00 b`; done

        `i2cset -y 1 0x70 0x00 0x08 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x08 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x70 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x70 0x00 0x00 b`; done

        # Configure Tx Disable, PCA9545(0x71), PCA9537(0x49) SFP+*4
        `i2cset -y 1 0x71 0x00 0x01 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x01 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x71 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x00 b`; done

        `i2cset -y 1 0x71 0x00 0x02 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x02 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x71 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x00 b`; done

        `i2cset -y 1 0x71 0x00 0x04 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x04 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x71 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x00 b`; done

        `i2cset -y 1 0x71 0x00 0x08 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x08 b`; done
        `i2cset -y 1 0x49 0x03 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf7 b`; done
        `i2cset -y 1 0x49 0x01 0xf7 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf7 b`; done
        `i2cset -y 1 0x71 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x71 0x00 0x00 b`; done

        # Configure Tx Disable, PCA9545(0x72), PCA9537(0x49) QSFP+*2
        `i2cset -y 1 0x72 0x00 0x01 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x72 0x00 0x01 b`; done
        `i2cset -y 1 0x49 0x03 0xf8 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf8 b`; done
        `i2cset -y 1 0x49 0x01 0xf5 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf5 b`; done
        `i2cset -y 1 0x72 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x72 0x00 0x00 b`; done

        `i2cset -y 1 0x72 0x00 0x02 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x72 0x00 0x02 b`; done
        `i2cset -y 1 0x49 0x03 0xf8 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x03 0xf8 b`; done
        `i2cset -y 1 0x49 0x01 0xf5 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x49 0x01 0xf5 b`; done
        `i2cset -y 1 0x72 0x00 0x00 b`; while [ "$?" == "1" ];do `i2cset -y 1 0x72 0x00 0x00 b`; done
}

giga_init

